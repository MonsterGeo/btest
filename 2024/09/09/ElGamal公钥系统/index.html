<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>ElGamal公钥系统 | Marcus&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="上一章我们讲了$D-H$密钥一种公开共享随机密钥的方法，但总的来说并没有实现作为公钥密码体系的全部目的，因为密码系统允许交换特定信息，而不仅仅是一串随机的bit。第一个公钥密码体系是$RSA$，Shamir和Adleman在1978提出。但我们这节讲的系统是在D-H写的论文之后发展比较自然的的系统。ElGamal公钥加密算法基于离散对数问题，接下来我们要谈的是基于$F^*_p$的离散对数问题的El">
<meta property="og:type" content="article">
<meta property="og:title" content="ElGamal公钥系统">
<meta property="og:url" content="https://monstergeo.github.io/btest/2024/09/09/ElGamal%E5%85%AC%E9%92%A5%E7%B3%BB%E7%BB%9F/">
<meta property="og:site_name" content="Marcus&#39;s Blog">
<meta property="og:description" content="上一章我们讲了$D-H$密钥一种公开共享随机密钥的方法，但总的来说并没有实现作为公钥密码体系的全部目的，因为密码系统允许交换特定信息，而不仅仅是一串随机的bit。第一个公钥密码体系是$RSA$，Shamir和Adleman在1978提出。但我们这节讲的系统是在D-H写的论文之后发展比较自然的的系统。ElGamal公钥加密算法基于离散对数问题，接下来我们要谈的是基于$F^*_p$的离散对数问题的El">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-09-09T13:56:03.000Z">
<meta property="article:modified_time" content="2024-09-09T20:02:22.330Z">
<meta property="article:author" content="Marcus">
<meta property="article:tag" content="密码学">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Marcus's Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Marcus&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Hello</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://monstergeo.github.io/btest"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-ElGamal公钥系统" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/09/09/ElGamal%E5%85%AC%E9%92%A5%E7%B3%BB%E7%BB%9F/" class="article-date">
  <time class="dt-published" datetime="2024-09-09T13:56:03.000Z" itemprop="datePublished">2024-09-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      ElGamal公钥系统
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>上一章我们讲了$D-H$密钥一种公开共享随机密钥的方法，但总的来说并没有实现作为公钥密码体系的全部目的，因为密码系统允许交换特定信息，而不仅仅是一串随机的bit。第一个公钥密码体系是$RSA$，<em>Shamir</em>和<em>Adleman</em>在1978提出。但我们这节讲的系统是在D-H写的论文之后发展比较自然的的系统。ElGamal公钥加密算法基于离散对数问题，接下来我们要谈的是基于$F^*_p$的离散对数问题的ElGamal Key版本。</p>
<p>爱丽丝选择一个数字$a$作为其私钥，并着手计算</p>
<center>

<p>$\begin{aligned}<br>    A \equiv g^a \mod p<br>\end{aligned}$</p>
</center>

<p>和D-H密钥交换相似之处为，爱丽丝将会公布她的公钥$A$，而保留私钥。</p>
<p>现在我们假设鲍勃想用爱丽丝的公钥$A$加密信息，首先我们假设鲍勃想用公钥$A$加密信息，设鲍勃的信息$m$是介于$0$到$p$之间的整数（可以用ASCII编码转换），为了加密$m$，首先我们选择一个$\mod p$的数字$k$，用它加密信息，然后将其丢弃，数字$k$称为临时密钥，因为其仅仅是用来加密单个信息</p>
<p>鲍勃取一段明文$m$，用随机临时密钥$k$和爱丽丝的公钥$A$计算两个等式</p>
<center>

<p>$\begin{aligned}<br>    c_1 \equiv g^k \mod p 和 c_2 \equiv m A^k \mod p<br>\end{aligned}$</p>
</center>

<p>则鲍勃的加密得到一对参数$(c_1,c_2)$。他将其发给爱丽丝。</p>
<p>那么爱丽丝如何解密$(c_1,c_2)$呢，由于爱丽丝知道$a$，则他可以计算值</p>
<center>

<p>$\begin{aligned}<br>    x \equiv c_1^a \mod p<br>\end{aligned}$</p>
</center>

<p>同样的也可以计算$x^{-1}$，接着将$c_2$乘$x^{-1}$，那我们就得到了明文$m$，我们来仔细看看$c_2 x^{-1}$</p>
<center>

<p>$\begin{aligned}x^{-1}\cdot c_{2}&amp;\equiv(c_1^a)^{-1}\cdot c_2\pmod{p}\&amp;\equiv(g^{ak})^{-1}\cdot(mA^k)\pmod{p}\&amp;\equiv(g^{ak})^{-1}\cdot(m(g^a)^k)\pmod{p}\&amp;\equiv m\pmod{p}\end{aligned}$</p>
</center>

<p>现在，若我们想破解密码，伊娃的任务是什么呢？首先，伊娃知道公共参数$p,g$，并且她知道$A &#x3D; g^a\mod p$的值。由于$A$是公钥，若伊娃能解决这个离散对数问题，则就能找到$a$并解密。</p>
<h4 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h4><p>爱丽丝选择素数$p &#x3D; 467$和原根$g&#x3D;2$，接着选择数$153$，接着计算公钥</p>
<center>

<p>$\begin{aligned}<br>A \equiv g^a \equiv 2^{153} \equiv 224 \mod 467<br>\end{aligned}$</p>
</center>


<p>接着，鲍勃的明文为$m &#x3D; 331$，它选择一个临时密钥$k &#x3D; 197$，则它需要计算两个值</p>
<center>

<p>$\begin{aligned}<br>    c_1 \equiv 2^{197}\equiv 87 \mod 467 和 c_2 \equiv 331\cdot 224^{197}\equiv 57\mod 467<br>\end{aligned}$</p>
</center>

<p>接着鲍勃发送$(87,57)$给爱丽丝。</p>
<p>爱丽丝用$a &#x3D;153$计算</p>
<center>

<p>$\begin{aligned}<br>    x\equiv c_1^a \equiv 87^{153} \equiv 367 \mod 467 \to x^{-1} \equiv 14\mod 467<br>\end{aligned}$</p>
</center>

<p>最后，我们就计算$c_2x^{-1} &#x3D; 57\cdot 14 \equiv 331 \mod 467$</p>
<p>就得到明文了。</p>
<p><strong>注意：</strong> 消息对$(c_1,c_2)$是2个字段组成，所以写下密文需要的位数一般是明文的两倍。</p>
<p>接着我们有一个问题，对于伊娃来说，ElGamal系统是否像D-H问题一样难以攻击？或者，我们可以引入一些巧妙的信息，使得它发挥了后门的作用。这样我们即使解决不了D-H问题也能够有效的获得信息。那么我们的任务是诸如识别像D-H这样的底层难题，并证明像ElGamal这样给定的加密构造至少和这些问题一样难以攻击。</p>
<p>那么我们实际的思考的问题就是：</p>
<h4 id="命题1"><a href="#命题1" class="headerlink" title="命题1"></a>命题1</h4><p>选定素数$p$和基$g$以用于$ElGamal$加密。设伊娃可以访问一个oracle(黑盒子)，oracle可以解密任意ElGamal公钥加密的密文，则伊娃可以使用它解决$D-H$问题。</p>
<p><strong>证明：</strong> 在$D-H$问题中，我们将得到两个密文 $A,B$，其中</p>
<center>

<p>$\begin{aligned}<br>    A\equiv g^a\pmod{p}\quad\text{and}\quad B\equiv g^b\pmod{p}<br>\end{aligned}$</p>
</center>

<p>则伊娃需要计算$g^{ab}\mod p$的值。但伊娃知道$A,B$而不知道$a,b$</p>
<p>现在，伊娃向oracle发送素数$p$，基$g$，一个假定的公钥$A$和一个假定的密文$(c_1,c_2)$。则oracle返回</p>
<center>

<p>$\begin{aligned}<br>    (c_1^a)^{-1}\cdot c_2\pmod{p}.<br>\end{aligned}$</p>
</center>

<p>最后一步，我们需要思考什么样的值是好的，使得问题能够解决，一种选择是$c_1 &#x3D; B &#x3D; g^b$和$c_2 &#x3D;1$。由这个输入，则返回$(g^{ab})^{-1}\mod p$，我们只需要对$\mod p$取逆就得到$g^{ab} \mod p$。于是我们就解决了$D-H$问题。</p>
<p>另一种方法，我们不试图解决DLP而是直接解决D-H问题。</p>
<p>伊娃选择任意的$c_2$，并告诉oracle公钥是$A$，密文是$(B,c_2)$。则返回</p>
<center>

<p>$\begin{aligned}<br>    m\equiv(c_1^a)^{-1}\cdot c_2\equiv(B^a)^{-1}\cdot c_2\equiv(g^{ab})^{-1}\cdot c_2\pmod{p}.<br>\end{aligned}$</p>
</center>

<p>在得道oracle返回的值$m$之后，我们只需要计算</p>
<center>

<p>$\begin{aligned}<br>    m^{-1}\cdot c_2 \equiv g^{ab} \mod p<br>\end{aligned}$</p>
</center>

<p>就求出了$g^{ab}\mod p$的值。但这次解决问题之后我们依然不知道$a,b$，所以我们只是解决了D-H问题而不是DLP。</p>
<p><strong>注意：</strong> 这种攻击称为选择密文攻击，我们刚才的证明告诉了我们ElGamal系统是可以抵御选择密文攻击的。更进一步，若假设$D-H$问题很难，则密文是安全的。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://monstergeo.github.io/btest/2024/09/09/ElGamal%E5%85%AC%E9%92%A5%E7%B3%BB%E7%BB%9F/" data-id="cmlgrfvf000076whx77ip1dqy" data-title="ElGamal公钥系统" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" rel="tag">密码学</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2024/09/12/%E7%BE%A4%E8%AE%BA%E6%A6%82%E8%BF%B0/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          群论概述
        
      </div>
    </a>
  
  
    <a href="/2024/09/08/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0%E9%97%AE%E9%A2%98/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">离散对数问题</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/MATLAB/">MATLAB</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/analyze/">analyze</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/computer/">computer</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Stm32/" rel="tag">Stm32</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithms/" rel="tag">algorithms</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/complex-analysis/" rel="tag">complex_analysis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/computer/" rel="tag">computer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/" rel="tag">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/matlab/" rel="tag">matlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tech/" rel="tag">tech</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/" rel="tag">图形学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" rel="tag">密码学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8E%9F%E7%90%86/" rel="tag">计算机原理</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/Stm32/" style="font-size: 12.5px;">Stm32</a> <a href="/tags/algorithms/" style="font-size: 15px;">algorithms</a> <a href="/tags/complex-analysis/" style="font-size: 20px;">complex_analysis</a> <a href="/tags/computer/" style="font-size: 10px;">computer</a> <a href="/tags/math/" style="font-size: 12.5px;">math</a> <a href="/tags/matlab/" style="font-size: 10px;">matlab</a> <a href="/tags/tech/" style="font-size: 10px;">tech</a> <a href="/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/" style="font-size: 10px;">图形学</a> <a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" style="font-size: 17.5px;">密码学</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8E%9F%E7%90%86/" style="font-size: 12.5px;">计算机原理</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2026/02/">February 2026</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/09/">September 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/08/">August 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/07/">July 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/06/">June 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/03/">March 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/02/">February 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">December 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">September 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">August 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">July 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/06/">June 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">April 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">January 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2026/02/10/liner_algebra/">利用MATLAB计算矩阵</a>
          </li>
        
          <li>
            <a href="/2026/02/10/bqj/">海涅-博雷尔定理</a>
          </li>
        
          <li>
            <a href="/2026/02/10/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2025/09/10/%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3/">合作式调度器</a>
          </li>
        
          <li>
            <a href="/2025/08/31/ocrs/">边缘识别</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2026 Marcus<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>