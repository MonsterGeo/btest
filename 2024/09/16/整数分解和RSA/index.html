<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>RSA 公钥密码系统 | Marcus&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="在这个章节，我们来讲RSA，之前的密钥系统基于离散对数问题，这次我们整点不一样的。RSA系统是以其发明者 Ron Rivest , Adi Shamir, Leonard Adleman的名字命名的。 RSA密码系统的安全性依赖下述分歧：  设置：令$p,q$是大素数，再令$N &#x3D; pq$和$e,c$是整数 问题：解关于$x$的同余式子$x^e \equiv c \mod N$ 容易性：">
<meta property="og:type" content="article">
<meta property="og:title" content="RSA 公钥密码系统">
<meta property="og:url" content="https://monstergeo.github.io/btest/2024/09/16/%E6%95%B4%E6%95%B0%E5%88%86%E8%A7%A3%E5%92%8CRSA/">
<meta property="og:site_name" content="Marcus&#39;s Blog">
<meta property="og:description" content="在这个章节，我们来讲RSA，之前的密钥系统基于离散对数问题，这次我们整点不一样的。RSA系统是以其发明者 Ron Rivest , Adi Shamir, Leonard Adleman的名字命名的。 RSA密码系统的安全性依赖下述分歧：  设置：令$p,q$是大素数，再令$N &#x3D; pq$和$e,c$是整数 问题：解关于$x$的同余式子$x^e \equiv c \mod N$ 容易性：">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-09-16T15:22:07.000Z">
<meta property="article:modified_time" content="2024-09-17T10:04:59.186Z">
<meta property="article:author" content="Marcus">
<meta property="article:tag" content="密码学">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Marcus's Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Marcus&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Hello</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://monstergeo.github.io/btest"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-整数分解和RSA" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/09/16/%E6%95%B4%E6%95%B0%E5%88%86%E8%A7%A3%E5%92%8CRSA/" class="article-date">
  <time class="dt-published" datetime="2024-09-16T15:22:07.000Z" itemprop="datePublished">2024-09-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      RSA 公钥密码系统
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>在这个章节，我们来讲RSA，之前的密钥系统基于离散对数问题，这次我们整点不一样的。RSA系统是以其发明者 <em>Ron Rivest , Adi Shamir, Leonard Adleman</em>的名字命名的。</p>
<p>RSA密码系统的安全性依赖下述分歧：</p>
<ul>
<li>设置：令$p,q$是大素数，再令$N &#x3D; pq$和$e,c$是整数</li>
<li>问题：解关于$x$的同余式子$x^e \equiv c \mod N$</li>
<li>容易性：只要知道$p,q$就能简单的计算出$x$</li>
<li>困难部分：若不清楚$p,q$，就无法找到$x$</li>
<li>分歧： 若不知道一些额外的信息，则很难解决这个问题。</li>
</ul>
<p>轮到鲍勃和爱丽丝登场了，鲍勃的密钥是一对大素数$p,q$，它们的公钥是一对$(N,e)$，由乘积$N$和一个与$(p-1)(q-1)$互素的加密指数$e$组成。</p>
<p>现在爱丽丝将明文转化为介于$1$到$N$之间的整数$m$，接着通过计算</p>
<center>

<p>$\begin{aligned}<br>    c \equiv m^e \mod N<br>\end{aligned}$</p>
</center>

<p>加密明文。而整数$c$是爱丽丝的密文，接着将其发给鲍勃。那么鲍勃只需简单的求解同余式子$x^e \equiv c \mod N$ 即可恢复爱丽丝的信息$m$，这是因为鲍勃知道因式分解$N &#x3D; pq$。其次，对于他俩的老对手伊娃，除非他知道如何分解$N$，否则很难解$x^e \equiv c\mod N$</p>
<h4 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h4><p>我们使用一个比较小的数字来说明RSA系统的实现，注意的是例子并不安全，因为数字太小，伊娃可以很简单的破解。实际使用中我们一般使用数百位数字的模数$N$</p>
<p><strong>RSA密钥创建：</strong></p>
<ol>
<li>鲍勃选择两个私密素数$p &#x3D; 1223$和$q &#x3D; 1987$，接着鲍勃计算它们的公开模数</li>
</ol>
<center>

<p>$\begin{aligned}<br>    N &#x3D; pq &#x3D; 2430101<br>\end{aligned}$</p>
</center>

<ol start="2">
<li>接着鲍勃选择一个公开的加密指数$e &#x3D; 948047$，它满足：</li>
</ol>
<center>

<p>$\begin{aligned}<br>    \gcd(e,(p-1)(q-1)) &#x3D; \gcd (948047,2426892) &#x3D; 1<br>\end{aligned}$</p>
</center>

<p><strong>RSA加密</strong></p>
<ol>
<li>爱丽丝将明文转化为整数</li>
</ol>
<center>

<p>$\begin{aligned}<br>    m &#x3D; 1070777 , 满足 1\leq m &lt; N<br>\end{aligned}$</p>
</center>

<ol start="2">
<li>爱丽丝使用鲍勃的公钥对$(N,e) &#x3D; (2430101, 948047)$计算</li>
</ol>
<center>

<p>$\begin{aligned}<br>    c\equiv m^e \mod N,~c \equiv 1070777^{948047} \equiv 1473513 \mod 2430101<br>\end{aligned}$</p>
</center>

<p>接着爱丽丝发送密文$c &#x3D; 14733513$给鲍勃。</p>
<p><strong>RSA解密</strong></p>
<ol>
<li>由于鲍勃知道$(p-1)(q-1) &#x3D; 1222\cdot 1986 &#x3D; 2426892$，则它可以计算</li>
</ol>
<center>

<p>$\begin{aligned}<br>    ed \equiv 1 \mod (p-1)(q-1) \to 948047\cdot d \equiv 1\mod 2426892<br>\end{aligned}$</p>
</center>

<p>那么简单计算可以得知$d &#x3D; 1051235$</p>
<ol start="2">
<li>接着鲍勃将密文$c &#x3D; 1473513$做计算：</li>
</ol>
<center>

<p>$\begin{aligned}<br>    c^d \mod N , 1473513^{1051235}\equiv 1070777\mod 2430101<br>\end{aligned}$</p>
</center>

<p>那么我们就得到了爱丽丝的明文$m &#x3D; 1070777$了。</p>
<p><strong>注释：</strong> 构成鲍勃公钥的值$N,e$分别称为模数和加密指数。而鲍勃用来解密爱丽丝消息的数字$d$满足：</p>
<center>

<p>$\begin{aligned}<br>    ed\equiv 1\mod (p-1)(q-1)<br>\end{aligned}$</p>
</center>

<p>称为解密指数，显然，若$e,d$是较小的，则加&#x2F;解密可以很简单的得到。但鲍勃不能选择它们都很小，因为一旦确定一个数，另一个数就由模数得到。当然，最重要的是不能取$d&#x3D;e&#x3D;1$。这样就没有加密了。</p>
<p>当然，你也不应该取$e&#x3D;2$，最小可能是$e&#x3D;3$。如果你担心$e$太小那么我们通常可以用$e &#x3D; 2^{16}+1 &#x3D; 65537$，因为我们只需要四次平方和一次乘法即可算的$m^65537$</p>
<p>另一方面，若我们让鲍勃选择较小的$d$，则同余式给出一个很大的$e$。然而若$d$小于$N^{1&#x2F;4}$，则使用连分数定理可以让伊娃破解RSA。</p>
<p>鲍勃的公钥包含数字$N &#x3D; pq$，它是两个秘密素数$pq$的乘积，若伊娃知道$(p-1)(q-1)$的值，则能够简单的解得$x^e \equiv c\mod N$。从而得到明文。</p>
<p>我们展开$(p-1)(q-1)$就有：</p>
<center>

<p>$\begin{aligned}<br>    (p-1)(q-1) &#x3D; pq-p-q+1 &#x3D; N-(p+q)+1<br>\end{aligned}$</p>
</center>

<p>由于$N$是公开的，所以伊娃知道$N$，因此我们只需要确定$p+q$是什么就可以得到$p,q$了。若伊娃知道$p+q$和$pq$，则我们只需要使用二次公式来找到多项式的根即可：</p>
<center>

<p>$\begin{aligned}<br>    x^2 -(p+q)x+pq<br>\end{aligned}$</p>
</center>

<p>那么该二次公式可以分解为$(x-q)(x-q)$。所以它的两个根就是$p,q$。</p>
<h4 id="例子-1"><a href="#例子-1" class="headerlink" title="例子"></a>例子</h4><p>我们举一个例子说明，若伊娃知道$N &#x3D; pq &#x3D; 66240912547$和$(p-1)(q-1) &#x3D; 66240396760$。</p>
<p>首先我们知道$p+q &#x3D; N+1 - (p-1)(q-1) &#x3D; 515788$</p>
<p>其次，利用二次公式有：</p>
<center>

<p>$\begin{aligned}<br>    x^2 -(p+q)X +N &#x3D; x^2 - 515788x+66240912547 &#x3D; (x-241511)(x-274277)<br>\end{aligned}$</p>
</center>


<h3 id="实施和安全性问题"><a href="#实施和安全性问题" class="headerlink" title="实施和安全性问题"></a>实施和安全性问题</h3><p>接下来我们提及一些安全方面的事实。我们不仅仅只讲密码学背后的数学原理，这样子远远不够。</p>
<h4 id="中间人攻击（Woman-in-the-Middle-Attack）"><a href="#中间人攻击（Woman-in-the-Middle-Attack）" class="headerlink" title="中间人攻击（Woman-in-the-Middle Attack）"></a>中间人攻击（Woman-in-the-Middle Attack）</h4><p>假设伊娃不仅仅是一个窃听者，它还完全控制着爱丽丝和鲍勃的通信网络。在这种情况下可以发起所谓的中间人攻击。</p>
<p>设想一下，在$D-H$密钥交换中，爱丽丝给鲍勃发送值$A &#x3D; g^a$。而鲍勃给爱丽丝发送$B &#x3D; g^b$，而且计算都是在有限域$F_p$中进行的。而现在，由于伊娃控制它们的通信网络，首先伊娃给自己指定了一个指数$e$计算$E &#x3D; g^e$。接着拦截了爱丽丝和鲍勃的通讯，接着伊娃给他们发送了数字E。注意这时候爱丽丝和鲍勃它们通讯是失败的，并没有收到对方的消息而是$E$。</p>
<p>设爱丽丝和鲍勃随后使用它们假定的密钥作为对称密码的密钥并互相发送消息，例如爱丽丝使用$E^a$加密消息$m$，则伊娃截获后可以用$A^e$作为密钥解密他，因此可以得到爱丽丝的信息。然后它使用$B^e$作为密钥重新发送给鲍勃。最后，因为鲍勃可以使用$E^b$解密，所以他不知道存在安全漏洞。</p>
<p>这个攻击的阴险之处在于，伊娃并没有破解密码，而是可以成功的读取爱丽丝和鲍勃的通讯而它们不知道他的成功。</p>
<h4 id="被截获了密文"><a href="#被截获了密文" class="headerlink" title="被截获了密文"></a>被截获了密文</h4><p>若爱丽丝发布了两个不同的指数$e_1,e_2$用于它的公开模数$N$，而鲍勃使用了爱丽丝的两个指数加密明文$m$。若被伊娃截获密文。那么</p>
<center>

<p>$\begin{aligned}<br>    c_1 \equiv m^{e_1} \mod N 和 c_2\equiv m^{e_2} \mod N<br>\end{aligned}$</p>
</center>


<p>那么我们可以选择两个数，计算$u,v$</p>
<center>

<p>$\begin{aligned}<br>    e_1\cdot u +e_2\cdot v &#x3D; \gcd(e_1,e_2)<br>\end{aligned}$</p>
</center>

<p>然后用$u,v$计算：</p>
<center>

<p>$\begin{aligned}<br>    e_1^u\cdot e^v_2 \equiv (m^e_1)^u\cdot (m^{e_2})^v \equiv m^{e_1\cdot u +e_2\cdot v} &#x3D; m^{\gcd(e_1,e_2)} \mod N<br>\end{aligned}$</p>
</center>


<p>若$\gcd(e_1,e_2) &#x3D;1$，则直接恢复明文。更一般的，若存在多个互素的指数$e_1,\cdots ,e_n$使得$\gcd(e_1,\cdots,e_n)&#x3D;1$，则我们可以恢复明文。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://monstergeo.github.io/btest/2024/09/16/%E6%95%B4%E6%95%B0%E5%88%86%E8%A7%A3%E5%92%8CRSA/" data-id="cmlgrfvfw001f6whx5bpzgc7x" data-title="RSA 公钥密码系统" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" rel="tag">密码学</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2024/12/10/%E7%B4%A0%E6%95%B0%E6%B5%8B%E8%AF%95/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          素数测试
        
      </div>
    </a>
  
  
    <a href="/2024/09/12/%E7%BE%A4%E8%AE%BA%E6%A6%82%E8%BF%B0/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">群论概述</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/MATLAB/">MATLAB</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/analyze/">analyze</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/computer/">computer</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Stm32/" rel="tag">Stm32</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithms/" rel="tag">algorithms</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/complex-analysis/" rel="tag">complex_analysis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/computer/" rel="tag">computer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/" rel="tag">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/matlab/" rel="tag">matlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tech/" rel="tag">tech</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/" rel="tag">图形学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" rel="tag">密码学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8E%9F%E7%90%86/" rel="tag">计算机原理</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/Stm32/" style="font-size: 12.5px;">Stm32</a> <a href="/tags/algorithms/" style="font-size: 15px;">algorithms</a> <a href="/tags/complex-analysis/" style="font-size: 20px;">complex_analysis</a> <a href="/tags/computer/" style="font-size: 10px;">computer</a> <a href="/tags/math/" style="font-size: 12.5px;">math</a> <a href="/tags/matlab/" style="font-size: 10px;">matlab</a> <a href="/tags/tech/" style="font-size: 10px;">tech</a> <a href="/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/" style="font-size: 10px;">图形学</a> <a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" style="font-size: 17.5px;">密码学</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8E%9F%E7%90%86/" style="font-size: 12.5px;">计算机原理</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2026/02/">February 2026</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/09/">September 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/08/">August 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/07/">July 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/06/">June 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/03/">March 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/02/">February 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">December 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">September 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">August 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">July 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/06/">June 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">April 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">January 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2026/02/10/liner_algebra/">利用MATLAB计算矩阵</a>
          </li>
        
          <li>
            <a href="/2026/02/10/bqj/">海涅-博雷尔定理</a>
          </li>
        
          <li>
            <a href="/2026/02/10/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2025/09/10/%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3/">合作式调度器</a>
          </li>
        
          <li>
            <a href="/2025/08/31/ocrs/">边缘识别</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2026 Marcus<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>