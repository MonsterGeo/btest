<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>素数测试 | Marcus&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="在前两章的学习之后，我们了解了RSA加密原理。现在Bob准备用他的密钥和Alice进行通讯。为了创建RSA密钥，首先我们需要选择大素数p,q，主要的原因是，若p,q不是素数，则Bob需要对其进行因式分解再运算，其次，若素数不够大，则Eve可以对pq进行因式分解从而破解密码。 所以这节的主旨是，如何寻找大素数，只需要用到几个很简单的结论即可。例如，我们设Bob已经选择了一个大数   $\begin{">
<meta property="og:type" content="article">
<meta property="og:title" content="素数测试">
<meta property="og:url" content="https://monstergeo.github.io/btest/2024/12/10/%E7%B4%A0%E6%95%B0%E6%B5%8B%E8%AF%95/">
<meta property="og:site_name" content="Marcus&#39;s Blog">
<meta property="og:description" content="在前两章的学习之后，我们了解了RSA加密原理。现在Bob准备用他的密钥和Alice进行通讯。为了创建RSA密钥，首先我们需要选择大素数p,q，主要的原因是，若p,q不是素数，则Bob需要对其进行因式分解再运算，其次，若素数不够大，则Eve可以对pq进行因式分解从而破解密码。 所以这节的主旨是，如何寻找大素数，只需要用到几个很简单的结论即可。例如，我们设Bob已经选择了一个大数   $\begin{">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-12-09T18:10:34.000Z">
<meta property="article:modified_time" content="2024-12-10T06:18:58.216Z">
<meta property="article:author" content="Marcus">
<meta property="article:tag" content="密码学">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Marcus's Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Marcus&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Hello</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://monstergeo.github.io/btest"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-素数测试" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/12/10/%E7%B4%A0%E6%95%B0%E6%B5%8B%E8%AF%95/" class="article-date">
  <time class="dt-published" datetime="2024-12-09T18:10:34.000Z" itemprop="datePublished">2024-12-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      素数测试
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>在前两章的学习之后，我们了解了RSA加密原理。现在Bob准备用他的密钥和Alice进行通讯。为了创建RSA密钥，首先我们需要选择大素数p,q，主要的原因是，若p,q不是素数，则Bob需要对其进行因式分解再运算，其次，若素数不够大，则Eve可以对pq进行因式分解从而破解密码。</p>
<p>所以这节的主旨是，如何寻找大素数，只需要用到几个很简单的结论即可。例如，我们设Bob已经选择了一个大数</p>
<center>

<p>$\begin{aligned}<br>    n &#x3D; 31987937737479355332620068643713101490952335301<br>\end{aligned}$</p>
</center>

<p>现在我们来判断其是否是素数，首先的是，经过简单的计算，小于100,0000的素数都不是其的因子。我们怀疑可能是真的素数，现在，我们计算$2^{n-1} \mod n$的值，那么经过计算机可以得到：</p>
<center>

<p>$\begin{aligned}<br>    2^{n-1} \equiv 1281265953551359064133601216247151836053160074 \mod n<br>\end{aligned}$</p>
</center>

<p>那么利用费马小定理，若p是素数，则$a^{p-1}\equiv 1 \mod p$（除非p$\mid $a，则由该同余式子，我们知道其是合数。现在我们描述一个更强一点的费马小定理</p>
<h2 id="费马小定理（版本2"><a href="#费马小定理（版本2" class="headerlink" title="费马小定理（版本2"></a>费马小定理（版本2</h2><p>令p是素数，则</p>
<center>

<p>$\begin{aligned}<br>    a^p\equiv a \mod p ~~~\text{对所有整数a成立}<br>\end{aligned}$</p>
</center>

<p><strong>证明：</strong> 若$p\nmid a$，由费马小定理$a^{p-1}\equiv 1 \mod p$两边乘a就可以得到$a^p \equiv a \mod p$。其次，若$p\mid a$，由整除性，$a \equiv 0 \mod p$意味着定理两边都是0，矛盾。</p>
<p>现在，鲍勃可以利用它找到一个大素数</p>
<center>

<p>$\begin{aligned}<br>    n &#x3D; 2967952985951692762820418740138329004315165131<br>\end{aligned}$</p>
</center>

<p>现在鲍勃选择计算$2^n \equiv 2 \mod n$，它现在准备逆用费马小定理的版本2.但这可能成功吗，答案是不一定的，考虑</p>
<center>

<p>$\begin{aligned}<br>    2^{341} \equiv 2 \mod 341 ，但 341&#x3D;11*31<br>\end{aligned}$</p>
</center>

<p>所以341不是一个素数。但这是个不错的开始，我们开始能缩小范围寻找素数。这促使我们做出如下的定义</p>
<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>固定整数n，我们说整数a是判断n的合数性的证据，则</p>
<center>

<p>$\begin{aligned}<br>    a^n\not\equiv a \mod n<br>\end{aligned}$</p>
</center>

<p>所以，若这种证据只有一个，则结合版本2的费马小定理则很容易验证n是否为合数，其次，讨论n是否是质数一个方法就是尝试非常多的数字$a_1,\cdots$。若其中有一个满足上述条件可以作为证据，则n是合数。但是，由于刚才的例子，若其中没有可以证明n是合数的证据，则我们继续对n是否是素数保持怀疑。</p>
<p>所以鲍勃需要一个比费马小定理更强的定理来生成素数。</p>
<h2 id="命题"><a href="#命题" class="headerlink" title="命题"></a>命题</h2><p>令p是奇素数且记</p>
<center>

<p>$\begin{aligned}<br>    p-1 &#x3D; 2^kq &amp; 其中q是奇数<br>\end{aligned}$</p>
</center>

<p>再设a是任何不被p整除的数，则a满足下述两个条件之一</p>
<ul>
<li>$a^q\equiv 1 \mod p$</li>
<li>$a^q,a^{2q},\cdots ,a^{2^{q-1}q},a^{2^kq}$其中有一个模$p$与 $-1$同余</li>
</ul>
<p><strong>证明：</strong> 费马小定理告诉我们$a^{p-1}\equiv 1\mod p$，则对列表</p>
<center>

<p>$\begin{aligned}<br>    a^q,a^{2q},\cdots ,a^{2^{q-1}q},a^{2^kq}<br>\end{aligned}$</p>
</center>

<p>的最后一个数有$\mod p$为1，注意列表每个数字都是前一个数字的平方，那么会有两种情况：</p>
<ol>
<li>列表中第一个数模$p$余1.</li>
<li>列表中一些数字不模$p$余1，但它的平方模$p$余1.</li>
</ol>
<p>但唯一满足两个条件的数</p>
<center>

<p>$\begin{aligned}<br>    b\not\equiv 1\mod p ~~~ 和 ~~~ b^2\equiv 1\mod p<br>\end{aligned}$</p>
</center>

<p>是$-1$，因此表中应该有一个数与$-1$同余。</p>
<p>现在我们给出一种较强的米勒-拉宾合数检验流程：</p>
<p>||给定测试数n，令a是待检验的合数性证据|<br>|:—-|:—-|:—-|<br>|1.|若n是偶数或者1 &lt; gcd(a,n)，则n是合数||<br>|2.|记n-1 &#x3D; $2^kq$，其中$q$是奇数||<br>|3.|令$a &#x3D; a^q\mod n$||<br>|4.|若a$\equiv 1\mod n$，则测试失败，n不一定是合数||<br>|5.|做循环$i&#x3D;0,1,\cdots,k-1$||<br>||6.若$a\equiv -1\mod n$，则测试失败|<br>||7.令$a&#x3D;a^2\mod n$|<br>|8.|增加i的次数并持续的做步骤5的循环验证|<br>|9.|得到n是合数|</p>
<p>从上述流程，我们把它重写为定义。<br>##定义</p>
<p>设$n$是奇数且记$n-1 &#x3D; 2^kq$，其中$q$是奇数。则满足gcd(a,n) &#x3D;1且满足下述两个条件的整数$a$称为a是n的米勒-拉宾的合数性证据</p>
<ul>
<li>$a^q\equiv 1 \mod n$</li>
<li>$a^{2^iq}\not\equiv -1 \mod n$对所有$i&#x3D;0,1,\cdots,k-1$成立。</li>
</ul>
<p>所以由上述流程，若a是n的一个合数性证据，则n一定是合数。现在假设 Bob 想要检查大数 n 是否可能是素数。为此，他使用一组随机选择的 a 值运行米勒-拉宾检验。为什么这比使用费马小定理检验更好？答案是，对于米勒-拉宾检验，我们可以避免诸如之前341这样的奇葩例子存在。因为我们严格的检验每个小于n-1的2的平方。而每个合数都有非常多的合数性证据。他们如下述定理所描述：</p>
<h2 id="命题-1"><a href="#命题-1" class="headerlink" title="命题"></a>命题</h2><p>令$n$是奇合数，则$1$到$n-1$的数字a中至少有$75%$都是n关于米勒-拉宾的合数性证据</p>
<p>这意味着Bob在寻找合数的时候都有75%的概率找到。假设Bob十次都没有找到合数的证据，这样的概率是$(25%)^{10}$，如果找了100次，这个概率将低至$(25%)^{100}\approx 10^{-60}$</p>
<p>现在给出一个例子</p>
<p>###例子</p>
<p>我们选择$a&#x3D;2$和$n&#x3D;561$做合数检验，现在有</p>
<p>$$<br>n-1 &#x3D; 560 &#x3D; 2^4 \cdot 35<br>$$</p>
<p>那么就有</p>
<center>

<p>$\begin{aligned}<br>    2^35 \equiv&amp; 264 \mod 561\<br>    2^{2<em>35}\equiv&amp; 263^2 \equiv 166 \mod 561\<br>    2^{4</em>35} \equiv&amp; 166^2 \equiv 67 \mod 561\<br>    2^{8*35} \equiv&amp; 67^2 \equiv 1\mod 561<br>\end{aligned}$</p>
</center>

<p>由于第一个数字是$\mod 561$既不是1也不是余1，所以它是合数。其他数最后也不是mod 561 余-1，所以定理告诉我们它是合数。</p>
<h3 id="例子2"><a href="#例子2" class="headerlink" title="例子2"></a>例子2</h3><p>我们取$n &#x3D; 172947529$和$n-1 &#x3D; 2^3 \cdot 21618441 &#x3D; 2^3\cdot q$</p>
<p>我们引用检验法在$a &#x3D; 17$上并试着找</p>
<p>$$<br>17^q \equiv 1\mod n<br>$$</p>
<p>对于第一个数$a^q, $它是$17^{21618441} \equiv 1\mod n$。测试不通过，现在尝试$a&#x3D;3$，则$3^q \equiv -1 \mod n$，测试也不通过，但我们选择$a&#x3D;23$的时候，有</p>
<p>$$<br>\begin{aligned}<br>    23^q \equiv 40063806 \mod n\<br>    23^{2q}\equiv 2257065 \mod n\<br>    23^{4q} \equiv 1 \mod n<br>\end{aligned}<br>$$</p>
<p>所以$n$也是一个合数，但就是有点难发现。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://monstergeo.github.io/btest/2024/12/10/%E7%B4%A0%E6%95%B0%E6%B5%8B%E8%AF%95/" data-id="cmlgqwxtp001n2ohx4tof2r9f" data-title="素数测试" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" rel="tag">密码学</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2025/02/12/%E9%93%BE%E8%A1%A8/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          链表
        
      </div>
    </a>
  
  
    <a href="/2024/09/16/%E6%95%B4%E6%95%B0%E5%88%86%E8%A7%A3%E5%92%8CRSA/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">RSA 公钥密码系统</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/MATLAB/">MATLAB</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/analyze/">analyze</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/computer/">computer</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Stm32/" rel="tag">Stm32</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithms/" rel="tag">algorithms</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/complex-analysis/" rel="tag">complex_analysis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/computer/" rel="tag">computer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/" rel="tag">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/matlab/" rel="tag">matlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tech/" rel="tag">tech</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/" rel="tag">图形学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" rel="tag">密码学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8E%9F%E7%90%86/" rel="tag">计算机原理</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/Stm32/" style="font-size: 12.5px;">Stm32</a> <a href="/tags/algorithms/" style="font-size: 15px;">algorithms</a> <a href="/tags/complex-analysis/" style="font-size: 20px;">complex_analysis</a> <a href="/tags/computer/" style="font-size: 10px;">computer</a> <a href="/tags/math/" style="font-size: 12.5px;">math</a> <a href="/tags/matlab/" style="font-size: 10px;">matlab</a> <a href="/tags/tech/" style="font-size: 10px;">tech</a> <a href="/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/" style="font-size: 10px;">图形学</a> <a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" style="font-size: 17.5px;">密码学</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8E%9F%E7%90%86/" style="font-size: 12.5px;">计算机原理</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2026/02/">February 2026</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/09/">September 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/08/">August 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/07/">July 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/06/">June 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/03/">March 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/02/">February 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">December 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">September 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">August 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">July 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/06/">June 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">April 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">January 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2026/02/10/liner_algebra/">利用MATLAB计算矩阵</a>
          </li>
        
          <li>
            <a href="/2026/02/10/bqj/">海涅-博雷尔定理</a>
          </li>
        
          <li>
            <a href="/2026/02/10/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2025/09/10/%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3/">合作式调度器</a>
          </li>
        
          <li>
            <a href="/2025/08/31/ocrs/">边缘识别</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2026 Marcus<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>